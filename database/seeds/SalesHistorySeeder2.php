<?php

use Illuminate\Database\Seeder;

class SalesHistorySeeder2 extends Seeder
{
    /**
     * Run the database seeds.
     *
     * @return void
     */
    public function run()
    {
        $year = 2018;
        $cultureId = 1;
        $userId = 2;
        $now = \Carbon\Carbon::now()->toDateTimeString();

        $items = [
            [6,5,102,15,1530],
            [8,5,106,15,1590],
            [10,5,57,20,1142],
            [12,5,44,19,836],
            [16,5,197,21.5,4235],
            [18,5,250,19,4750],
            [20,5,257,11.5,2955],
            [22,5,152,5.5,836],
            [24,5,223,7,1561],
            [26,5,395,5.2,2050],
            [28,5,387,4.3,1664],
            [30,5,386,3,1160],
            [1,6,260,3.5,910],
            [3,6,466,3,1400],
            [5,6,680,3,2040],
            [7,6,511,2.5,1277],
            [9,6,482,5.5,2650],
            [11,6,462,3,1386],
            [13,6,533,5,2665],
            [15,6,809,4.4,3560],
            [17,6,676,2.8,1895],
            [19,6,592,2.2,1300],
            [21,6,500,5.5,2750],
            [23,6,695,5,3475],
            [25,6,478,3,null],
            [27,6,430,2.8,1200],
            [29,6,300,3,1500],
            [1,7,713,3,2139],
            [3,7,480,1,480],
            [5,7,250,4.5,1130],
            [7,7,377,5,1885],
            [9,7,711,6.5,4620],
            [11,7,749,1.8,1348],
            [13,7,352,2.5,880],
            [15,7,328,3,984],
            [17,7,475,3,1425],
            [19,7,525,3.5,1837],
            [20,7,150,4,600],
            [23,7,516,4,2064],
            [25,7,381,3.5,1330],
            [27,7,343,5.5,1880],
            [29,7,300,5.5,1650],
            [31,7,256,6.2,1580],
            [2,8,373,8,2980],
            [4,8,363,9,3267],
            [6,8,350,7.5,2625],
            [8,8,332,8,2656],
            [11,8,340,6.5,2210],
            [14,8,340,8.5,2880],
            [16,8,173,9,1557],
            [19,8,273,4,null],
            [22,8,211,8,1688],
            [24,8,95,11,1045],
            [27,8,113,9,1017],
            [30,8,75,3,null],
            [8,9,133,7.5,1000],
        ];

        $toInsert = [];

        foreach ($items as $item){
            $dt = \Carbon\Carbon::create($year, $item[1], $item[0])->toDateString();
            $checkExist = \App\Models\SalesHistory::where([
                'user_id' => $userId,
                'culture_id' => $cultureId,
                'date' => $userId,
                'price' => $item[3],
                'weight' => $item[2],
            ])->exists();

            if($checkExist){
                continue;
            }

            $toInsert[] = [
                'user_id' => $userId,
                'culture_id' => $cultureId,
                'price' => $item[3],
                'weight' => $item[2],
                'sum' => isset($item[4]) ? $item[4] : ($item[2] * $item[3]),
                'date' => $dt,
                'created_at' => $now,
            ];
        }

        \App\Models\SalesHistory::insert($toInsert);

    }
}
