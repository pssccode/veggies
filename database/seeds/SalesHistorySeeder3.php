<?php

use Illuminate\Database\Seeder;

class SalesHistorySeeder3 extends Seeder
{
    /**
     * Run the database seeds.
     *
     * @return void
     */
    public function run()
    {
        $year = 2017;
        $cultureId = 1;
        $userId = 2;
        $now = \Carbon\Carbon::now()->toDateTimeString();

        $items = [
            [9,5,23,16,368],
            [12,5,47,22,1034],
            [17,5,23,17,391],
            [19,5,57,20,1440],
            [21,5,100,18.5,1850],
            [23,5,70,16.5,1455],
            [25,5,62,18,1116],
            [27,5,102,12,1224],
            [29,5,134,7,930],
            [31,5,141,12,1692],
            [2,6,147,6.5,955],
            [4,6,201,6.5,1306],
            [6,6,245,6,1470],
            [8,6,299,6.2,1853],
            [10,6,539,6.5,3503],
            [12,6,368,5.7,2100],
            [14,6,153,4,615],
            [16,6,250,11.5,2875],
            [18,6,523,9,4700],
            [20,6,716,8,5720],
            [22,6,559,5.5,3070],
            [24,6,426,4,1700],
            [26,6,516,2.5,1290],
            [28,6,699,5.7,3980],
            [30,6,635,2.5,1580],
            [2,7,420,2,840],
            [4,7,378,3.5,1320],
            [6,7,237,8,1900],
            [8,7,390,6.5,2535],
            [10,7,260,6.5,1690],
            [12,7,330,5,1650],
            [14,7,389,3,1167],
            [16,7,324,4,1360],
            [18,7,218,5.5,1199],
            [20,7,260,11.5,2990],
            [22,7,372,9,3348],
            [24,7,270,6,1620],
            [26,7,251,6,1500],
            [28,7,238,11,2595],
            [30,7,321,9,2890],
            [31,7,128,9,1152],
            [3,8,267,8,2136],
            [5,8,291,9.5,2770],
            [7,8,240,10,2400],
            [9,8,170,8,1360],
            [11,8,194,11.5,2330],
            [13,8,272,13.5,null],
            [15,8,222,14,3100],
            [17,8,144,13,1870],
            [19,8,128,9,1152],
            [21,8,172,11,1890],
            [23,8,159,15,2380],
            [25,8,92,16,1472],
            [27,8,80,16,1280],
            [29,8,88,12,1050],
            [2,9,96,14,1344],
            [4,9,75,14,1050],
            [6,9,71,9,639],
            [9,9,41,8,null],
        ];

        $toInsert = [];

        foreach ($items as $item){
            $dt = \Carbon\Carbon::create($year, $item[1], $item[0])->toDateString();
            $checkExist = \App\Models\SalesHistory::where([
                'user_id' => $userId,
                'culture_id' => $cultureId,
                'date' => $userId,
                'price' => $item[3],
                'weight' => $item[2],
            ])->exists();

            if($checkExist){
                continue;
            }

            $toInsert[] = [
                'user_id' => $userId,
                'culture_id' => $cultureId,
                'price' => $item[3],
                'weight' => $item[2],
                'sum' => isset($item[4]) ? $item[4] : ($item[2] * $item[3]),
                'date' => $dt,
                'created_at' => $now,
            ];
        }

        \App\Models\SalesHistory::insert($toInsert);

    }
}
